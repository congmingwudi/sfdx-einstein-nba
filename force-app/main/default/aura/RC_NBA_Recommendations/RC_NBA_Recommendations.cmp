<!--
 - Created by ryan.cox on 6/2/20.
 -->

<aura:component description="RC_NBA_Recommendations" implements="flexipage:availableForAllPageTypes, forceCommunity:availableForAllPageTypes, lightning:availableForFlowScreens" access="global" controller="RC_NBA_RecommendationsController">

    <!-- input parameters -->
    <aura:attribute name="recordType" type="String" access="global" default=""/>
    <aura:attribute name="record_Label" type="String" access="global" default="RECOMMENDATION"/>
    <aura:attribute name="record_PluralLabel" type="String" access="global" default="RECOMMENDATIONS"/>

    <!-- private attributes -->
    <aura:attribute name="record" type="Recommendation"/>
    <aura:attribute name="recordList" type="List" default="[]"/>
    <aura:attribute name="errorMessage" type="String" default=""/>

    <!-- handlers -->
    <aura:handler name="init" action="{!c.init}" value="{!this}"/>

    <lightning:layout horizontalAlign="spread">

        <!-- error message -->
        <aura:if isTrue="{!v.errorMessage != ''}">
            <lightning:layoutItem flexibility="auto" padding="around-small" class="slds-align_absolute-center">
                <ui:outputText value="{!v.errorMessage}" class="errorMessage"/>
            </lightning:layoutItem>
        </aura:if>

    </lightning:layout>

    <!-- TABLE attributes -->
    <aura:attribute name="tableData" type="Object"/>
    <aura:attribute name="tableColumns" type="List"/>
    <aura:attribute name="isLoading" type="Boolean" default="false"/>
    <aura:attribute name="sortedBy" type="String"/>
    <aura:attribute name="sortedDirection" type="String"/>
    <aura:attribute name="defaultSortDirection" type="String"/>

    <!-- TABLE -->
    <lightning:layout multipleRows="true">
        <lightning:layoutItem padding="around-small" size="12">
            <lightning:card title="{!v.record_PluralLabel + ' (' + v.recordList.length + ')'}">

                <!-- the container element determine the height of the datatable -->
                <div style="height: 300px" class="slds-scrollable">
                    <lightning:datatable aura:id="recordTable"
                                         data="{! v.tableData }"
                                         columns="{! v.tableColumns }"
                                         keyField="Name"
                                         onrowselection="{! c.getSelectedName }"
                                         hideCheckboxColumn="true"
                                         showRowNumberColumn="true"
                                         sortedBy="{! v.sortedBy }"
                                         sortedDirection="{! v.sortedDirection }"
                                         defaultSortDirection="{! v.defaultSortDirection }"
                                         onsort="{! c.updateColumnSorting }"
                                         onrowaction="{! c.handleRowAction }"
                                         onsave="{! c.handleSave }"
                                         class="slds-p-around_medium" />
                </div>
                <aura:if isTrue="{! v.isLoading }">
                    <lightning:spinner alternativeText="Loading"/>
                </aura:if>
            </lightning:card>

        </lightning:layoutItem>
    </lightning:layout>
    <!-- / TABLE -->

</aura:component>